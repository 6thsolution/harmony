TODO:

storage errors are not handled well or tested ...
